# No Padding, No Problem

## Description
Oracles can be your best friend, they will decrypt anything, except the flag's ciphertext. How will you break it? Connect with `nc mercury.picoctf.net 60368`.

## Accesos
What can you do with a different pair of ciphertext and plaintext? What if it is not so different after all...


## Solucion

```bash
┌──(yareds45㉿yareds45)-[~/develop]
└─$ nc mercury.picoctf.net 60368
Welcome to the Padding Oracle Challenge
This oracle will take anything you give it and decrypt using RSA. It will not accept the ciphertext with the secret message... Good Luck!


n: 110246896365671269866710696787899193655296516025908645165758380173330011663456159668124817656768060980663471736767890618552885337082176193676741157144692726753426734263123608434395101308159865421492650022387055719659566746861819327659047228026852618649476186975237831287497383937911512601503342375264891845297
e: 65537
ciphertext: 108175516150303164122315530251978716737028463787718298263998666831465840815072129879358080477433965097196153800452476001087016542483169687476590994849027850474821665460255902603202608775133808933652225522360771054428175400141269850613666902517105779992760475064705777526293872914994504780642963888456981640788


Give me ciphertext to decrypt: 5016266979685971996604642045925468497759774372257802085814311299183714075811807320086089027252400426633523376638940203836693994103302398555750632695269911545658405095227717053344820743207165194739319083619227587918199072105840563385886600816124253247726488110264710018155306544481015499828828778711112283953889590905960558648860675237860166375269965489163737848634529569461178673384923019095333286726915528767447656479266980422485570299980794851143562587295293257271684809800560812508883172975022066083773086040770923182094994394161864790666949843543795754130090976793637583950367420065758714971872878784522404565828
Here you go: 580550060391700078946913236734911770139931497702556153513487440893406629034802718534645538074938502890769138695361576199930




python3 

>>> n = 110246896365671269866710696787899193655296516025908645165758380173330011663456159668124817656768060980663471736767890618552885337082176193676741157144692726753426734263123608434395101308159865421492650022387055719659566746861819327659047228026852618649476186975237831287497383937911512601503342375264891845297
>>> e = 65537
>>> c = 108175516150303164122315530251978716737028463787718298263998666831465840815072129879358080477433965097196153800452476001087016542483169687476590994849027850474821665460255902603202608775133808933652225522360771054428175400141269850613666902517105779992760475064705777526293872914994504780642963888456981640788
>>> x = pow(2,e,n)
>>> c * x
5016266979685971996604642045925468497759774372257802085814311299183714075811807320086089027252400426633523376638940203836693994103302398555750632695269911545658405095227717053344820743207165194739319083619227587918199072105840563385886600816124253247726488110264710018155306544481015499828828778711112283953889590905960558648860675237860166375269965489163737848634529569461178673384923019095333286726915528767447656479266980422485570299980794851143562587295293257271684809800560812508883172975022066083773086040770923182094994394161864790666949843543795754130090976793637583950367420065758714971872878784522404565828
>>> m = 580550060391700078946913236734911770139931497702556153513487440893406629034802718534645538074938502890769138695361576199930
>>> m = 580550060391700078946913236734911770139931497702556153513487440893406629034802718534645538074938502890769138695361576199930 // 2
>>> long_to_bytes(m)
>>> b'picoCTF{m4yb3_Th0se_m3s54g3s_4r3_difurrent_3279013}'

```

picoCTF{m4yb3_Th0se_m3s54g3s_4r3_difurrent_3279013}

## Referencias

P - numero primo
Q - numero primo
N - modulo
tn - totient n
E - exponente (llave publica) - 65337
D - llave privada
C - mensaje cifrado
M - mensaje en texto plano

n = p * q
tn = (p-1) * (q-1)
d = e mod inv tn      //  inverse(e,tn)

Encriptar: pow(m,e,n)
c = m ^ e mod n

Desencriptar: pow(c,d,n)
m = c ^ d mod n